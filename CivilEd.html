<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Citizen: ‡∏Æ‡∏µ‡πÇ‡∏£‡πà‡∏û‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏î‡∏µ</title>
    <!-- Google Fonts: Mali (‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡∏≠) ‡πÅ‡∏•‡∏∞ Kanit (‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢) -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Mali:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        display: ['Mali', 'cursive'],
                        body: ['Kanit', 'sans-serif'],
                    },
                    colors: {
                        kid: {
                            blue: '#4FACFE',
                            blueDark: '#0072ff',
                            orange: '#FFA067',
                            orangeDark: '#FF6B6B',
                            green: '#43E97B',
                            greenDark: '#38F9D7',
                            yellow: '#FFED4B',
                            purple: '#A18CD1',
                            bg: '#E0F7FA'
                        }
                    },
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                        'wiggle': 'wiggle 1s ease-in-out infinite',
                        'pop': 'pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)',
                    },
                    keyframes: {
                        wiggle: {
                            '0%, 100%': { transform: 'rotate(-3deg)' },
                            '50%': { transform: 'rotate(3deg)' },
                        },
                        pop: {
                            '0%': { transform: 'scale(0.8)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #E0F7FA;
            background-image: radial-gradient(#4FACFE 15%, transparent 16%), radial-gradient(#FFA067 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
        }

        /* 3D Button Style */
        .btn-3d {
            transition: all 0.1s;
            transform: translateY(0);
            box-shadow: 0 6px 0 rgba(0,0,0,0.15);
        }
        .btn-3d:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 rgba(0,0,0,0.15);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888; 
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555; 
        }

        .emoji-scene {
            font-size: 4rem;
            line-height: 1;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2));
        }

        .stat-icon-wrapper {
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center font-body p-4">

    <div id="app" class="w-full max-w-lg bg-white rounded-[2rem] shadow-[0_10px_40px_rgba(0,0,0,0.1)] overflow-hidden relative min-h-[650px] flex flex-col border-4 border-white ring-4 ring-kid-blue/30">
        
        <!-- Game HUD -->
        <header id="hud" class="hidden bg-white p-4 z-20 border-b-2 border-gray-100">
            <div class="flex justify-between items-center mb-4">
                <div class="bg-kid-blue/20 text-kid-blueDark px-4 py-1 rounded-full font-display font-bold text-lg">
                    ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà <span id="q-current">1</span>/5
                </div>
                <div class="text-right">
                    <h1 class="font-display text-xl text-gray-700 font-bold">ü¶∏ Super Citizen</h1>
                </div>
            </div>
            
            <!-- Stats Bar (HP Style) -->
            <div class="grid grid-cols-3 gap-3">
                <!-- Law -->
                <div class="flex flex-col items-center">
                    <div class="stat-icon-wrapper w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-xl mb-1 border-2 border-blue-200 z-10">‚öñÔ∏è</div>
                    <div class="w-full bg-gray-200 rounded-full h-4 border-2 border-white shadow-inner overflow-hidden relative -mt-3 pt-2">
                        <div id="bar-law" class="h-full bg-blue-400 transition-all duration-500" style="width: 50%"></div>
                    </div>
                </div>
                <!-- Heart -->
                <div class="flex flex-col items-center">
                    <div class="stat-icon-wrapper w-10 h-10 bg-pink-100 rounded-full flex items-center justify-center text-xl mb-1 border-2 border-pink-200 z-10">‚ù§Ô∏è</div>
                    <div class="w-full bg-gray-200 rounded-full h-4 border-2 border-white shadow-inner overflow-hidden relative -mt-3 pt-2">
                        <div id="bar-public" class="h-full bg-pink-400 transition-all duration-500" style="width: 50%"></div>
                    </div>
                </div>
                <!-- Happy -->
                <div class="flex flex-col items-center">
                    <div class="stat-icon-wrapper w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center text-xl mb-1 border-2 border-yellow-200 z-10">üòÅ</div>
                    <div class="w-full bg-gray-200 rounded-full h-4 border-2 border-white shadow-inner overflow-hidden relative -mt-3 pt-2">
                        <div id="bar-happy" class="h-full bg-yellow-400 transition-all duration-500" style="width: 50%"></div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow relative flex flex-col bg-gradient-to-b from-white to-blue-50">
            
            <!-- 1. Start Screen -->
            <div id="start-screen" class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center z-30 bg-white">
                <div class="animate-bounce-slow mb-4 relative">
                    <div class="text-[8rem] leading-none">ü¶∏‚Äç‚ôÇÔ∏è</div>
                    <div class="absolute bottom-0 right-0 text-6xl animate-wiggle origin-bottom">üáπüá≠</div>
                </div>
                
                <h1 class="font-display text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-kid-blueDark to-kid-purple mb-2 drop-shadow-sm">
                    ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à<br>‡∏Æ‡∏µ‡πÇ‡∏£‡πà‡∏û‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏î‡∏µ
                </h1>
                <p class="font-body text-gray-500 text-lg mb-8">‡∏°‡∏≤‡∏™‡∏∞‡∏™‡∏°‡∏û‡∏•‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ<br>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡∏Æ‡∏µ‡πÇ‡∏£‡πà‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞!</p>

                <div class="w-full max-w-xs space-y-4">
                    <button onclick="game.start()" class="btn-3d w-full bg-gradient-to-r from-kid-green to-kid-greenDark text-white font-display text-2xl py-4 rounded-2xl border-b-4 border-green-600">
                        üéÆ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢
                    </button>
                    <div class="text-xs text-gray-400 bg-gray-50 p-2 rounded-lg">
                        *‡πÄ‡∏Å‡∏°‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ù‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á
                    </div>
                </div>
            </div>

            <!-- 2. Gameplay Screen -->
            <div id="game-screen" class="hidden flex-col flex-grow p-4 pb-20 overflow-y-auto animate-pop">
                
                <!-- Visual Scene -->
                <div class="bg-white rounded-3xl p-6 shadow-sm border-2 border-dashed border-gray-200 mb-6 flex flex-col items-center justify-center min-h-[180px] relative overflow-hidden">
                    <div class="absolute inset-0 bg-kid-bg opacity-50"></div>
                    <div id="scene-visual" class="emoji-scene relative z-10 flex items-end space-x-2">
                        <!-- Emojis injected via JS -->
                    </div>
                </div>

                <!-- Question -->
                <div class="mb-4 text-center">
                    <h2 id="scenario-title" class="font-display text-2xl text-kid-blueDark font-bold mb-2"></h2>
                    <p id="scenario-desc" class="text-gray-600 text-lg leading-relaxed"></p>
                </div>

                <!-- Choices -->
                <div id="choices-container" class="space-y-4 mt-auto">
                    <!-- Buttons injected via JS -->
                </div>
            </div>

            <!-- 3. Feedback Modal -->
            <div id="feedback-overlay" class="hidden absolute inset-0 bg-black/60 z-40 flex items-center justify-center p-4 backdrop-blur-sm">
                <div class="bg-white w-full max-w-sm rounded-[2rem] p-6 text-center shadow-2xl animate-pop border-4 border-white relative overflow-hidden">
                    <!-- Background Shine -->
                    <div class="absolute top-0 left-0 w-full h-20 bg-gradient-to-b from-yellow-100 to-transparent opacity-50"></div>
                    
                    <div id="feedback-icon" class="text-7xl mb-2 relative z-10 drop-shadow-md">‚ú®</div>
                    <h3 id="feedback-title" class="font-display text-2xl font-bold text-gray-800 mb-2 relative z-10"></h3>
                    <p id="feedback-desc" class="font-body text-gray-600 mb-6 relative z-10"></p>
                    
                    <!-- Score Board -->
                    <div class="bg-gray-50 rounded-2xl p-4 mb-6 border border-gray-100 relative z-10">
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div>
                                <div class="text-xl">‚öñÔ∏è</div>
                                <div id="change-law" class="font-display font-bold text-lg"></div>
                            </div>
                            <div>
                                <div class="text-xl">‚ù§Ô∏è</div>
                                <div id="change-public" class="font-display font-bold text-lg"></div>
                            </div>
                            <div>
                                <div class="text-xl">üòÅ</div>
                                <div id="change-happy" class="font-display font-bold text-lg"></div>
                            </div>
                        </div>
                    </div>

                    <button onclick="game.next()" class="btn-3d w-full bg-kid-orange text-white font-display text-xl py-3 rounded-xl border-b-4 border-orange-600 relative z-10">
                        ‡πÑ‡∏õ‡∏î‡πà‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‚è©
                    </button>
                </div>
            </div>

            <!-- 4. End Screen -->
            <div id="end-screen" class="hidden absolute inset-0 bg-white z-30 flex flex-col items-center p-6 overflow-y-auto">
                <div class="w-full text-center mt-6">
                    <div class="relative inline-block">
                        <div class="absolute inset-0 bg-yellow-300 rounded-full blur-xl opacity-50 animate-pulse"></div>
                        <div id="final-emoji" class="text-8xl relative z-10 animate-bounce-slow">üèÜ</div>
                    </div>
                    
                    <h2 class="font-display text-3xl font-bold text-kid-blueDark mt-4 mb-1">‡∏à‡∏ö‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡πâ‡∏ß!</h2>
                    <p class="text-gray-500">‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏â‡∏≤‡∏¢‡∏≤:</p>
                    <div id="final-rank" class="font-display text-4xl font-bold text-kid-orangeDark my-4 drop-shadow-sm bg-orange-50 py-2 px-4 rounded-xl border-2 border-orange-100 inline-block transform -rotate-2"></div>
                    <p id="final-comment" class="text-gray-600 px-4 mb-8"></p>
                </div>

                <!-- Final Bars -->
                <div class="w-full bg-white rounded-2xl p-6 shadow-lg border border-gray-100 mb-8 space-y-4">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl bg-blue-100 p-2 rounded-lg">‚öñÔ∏è</span>
                        <div class="flex-1">
                            <div class="flex justify-between font-display text-sm text-gray-500 mb-1"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢</span><span id="end-law"></span></div>
                            <div class="h-3 w-full bg-gray-100 rounded-full"><div id="end-bar-law" class="h-full bg-blue-400 rounded-full"></div></div>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="text-2xl bg-pink-100 p-2 rounded-lg">‚ù§Ô∏è</span>
                        <div class="flex-1">
                            <div class="flex justify-between font-display text-sm text-gray-500 mb-1"><span>‡∏à‡∏¥‡∏ï‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</span><span id="end-public"></span></div>
                            <div class="h-3 w-full bg-gray-100 rounded-full"><div id="end-bar-public" class="h-full bg-pink-400 rounded-full"></div></div>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="text-2xl bg-yellow-100 p-2 rounded-lg">üòÅ</span>
                        <div class="flex-1">
                            <div class="flex justify-between font-display text-sm text-gray-500 mb-1"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç</span><span id="end-happy"></span></div>
                            <div class="h-3 w-full bg-gray-100 rounded-full"><div id="end-bar-happy" class="h-full bg-yellow-400 rounded-full"></div></div>
                        </div>
                    </div>
                </div>

                <button onclick="game.restart()" class="btn-3d w-full bg-kid-purple text-white font-display text-xl py-4 rounded-xl border-b-4 border-purple-700 mt-auto shadow-xl">
                    üîÑ ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                </button>
            </div>

        </main>
    </div>

    <!-- Game Logic -->
    <script>
        // Scenarios Data (Adapted for Kids with Visual Scene Composition)
        const scenarios = [
            {
                id: 1,
                title: "‡πÑ‡∏ü‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏ß‡∏±‡∏î‡πÉ‡∏à! üö¶",
                desc: "‡∏´‡∏ô‡∏π‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏±‡πà‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡πÑ‡∏õ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏£‡∏µ‡∏ö‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢ ‡πÅ‡∏ï‡πà‡∏û‡∏≠‡∏ñ‡∏∂‡∏á‡πÅ‡∏¢‡∏Å‡πÑ‡∏ü‡∏à‡∏£‡∏≤‡∏à‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô '‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á' ‡∏à‡∏∞‡∏ó‡∏≥‡πÑ‡∏á‡∏î‡∏µ?",
                visual: "üè´ üö¥ üí® üö¶", // Emoji Scene
                choices: [
                    {
                        text: "‡πÄ‡∏ö‡∏£‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≠‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß",
                        feedback: {
                            title: "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! üëç",
                            desc: "‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô ‡∏ñ‡∏∂‡∏á‡∏ä‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏≠‡∏¢‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏à‡πá‡∏ö‡∏ï‡∏±‡∏ß‡∏ô‡∏∞",
                            icon: "‚úÖ"
                        },
                        effects: { law: 15, public: 5, happy: -10 }
                    },
                    {
                        text: "‡∏õ‡∏±‡πà‡∏ô‡πÄ‡∏£‡πá‡∏ß‡∏à‡∏µ‡πã ‡∏ù‡πà‡∏≤‡πÑ‡∏õ‡πÄ‡∏•‡∏¢!",
                        feedback: {
                            title: "‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ô‡∏∞! üò±",
                            desc: "‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡πÑ‡∏ü‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡∏ä‡∏ô‡∏Å‡∏±‡∏ö‡∏£‡∏ñ‡∏≠‡∏µ‡∏Å‡∏ù‡∏±‡πà‡∏á‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°‡πÄ‡∏•‡∏¢",
                            icon: "üí•"
                        },
                        effects: { law: -20, public: -10, happy: 10 }
                    }
                ]
            },
            {
                id: 2,
                title: "‡∏Ç‡∏¢‡∏∞‡∏•‡πâ‡∏ô‡∏ñ‡∏±‡∏á üóëÔ∏è",
                desc: "‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏ß‡∏≤‡∏ô‡∏´‡∏°‡∏î‡πÅ‡∏Å‡πâ‡∏ß‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡∏ó‡∏¥‡πâ‡∏á‡∏Ç‡∏¢‡∏∞‡πÅ‡∏ï‡πà‡∏ñ‡∏±‡∏á‡∏ï‡∏£‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏±‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏ô‡∏•‡πâ‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏•‡∏¢",
                visual: "ü•§ üôÑ üóëÔ∏è üöÆ",
                choices: [
                    {
                        text: "‡∏ß‡∏≤‡∏á‡πÅ‡∏õ‡∏∞‡πÜ ‡πÑ‡∏ß‡πâ‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô‡∏ô‡∏±‡πà‡∏ô‡πÅ‡∏´‡∏•‡∏∞",
                        feedback: {
                            title: "‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡πÄ‡∏•‡∏¢ üôÖ‚Äç‚ôÇÔ∏è",
                            desc: "‡∏ñ‡πâ‡∏≤‡∏•‡∏°‡∏û‡∏±‡∏î‡∏Ç‡∏¢‡∏∞‡∏à‡∏∞‡∏õ‡∏•‡∏¥‡∏ß‡πÄ‡∏•‡∏≠‡∏∞‡πÄ‡∏ó‡∏≠‡∏∞ ‡∏™‡∏á‡∏™‡∏≤‡∏£‡∏û‡∏µ‡πà‡∏Ñ‡∏ô‡∏Å‡∏ß‡∏≤‡∏î‡∏Ç‡∏¢‡∏∞‡∏ô‡∏∞",
                            icon: "üßπ"
                        },
                        effects: { law: -5, public: -20, happy: 5 }
                    },
                    {
                        text: "‡∏ñ‡∏∑‡∏≠‡πÑ‡∏õ‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á",
                        feedback: {
                            title: "‡∏à‡∏¥‡∏ï‡πÉ‡∏à‡∏á‡∏î‡∏á‡∏≤‡∏°! ‚ú®",
                            desc: "‡∏¢‡∏≠‡∏°‡∏•‡∏≥‡∏ö‡∏≤‡∏Å‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡πÅ‡∏ï‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏≤‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏•‡∏¢",
                            icon: "üåü"
                        },
                        effects: { law: 5, public: 15, happy: -5 }
                    }
                ]
            },
            {
                id: 3,
                title: "‡∏Ñ‡∏¥‡∏ß‡∏Ñ‡∏∏‡∏ì‡∏õ‡πâ‡∏≤‡∏¢‡∏≤‡∏ß‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î üèß",
                desc: "‡∏´‡∏ô‡∏π‡∏ï‡πà‡∏≠‡πÅ‡∏ñ‡∏ß‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏ô‡∏° ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∏‡∏ì‡∏õ‡πâ‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏≤‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ô‡∏≤‡∏ô‡∏°‡∏≤‡∏Å‡∏Å‡∏Å ‡πÅ‡∏ñ‡∏ß‡∏Å‡πá‡∏¢‡∏≤‡∏ß",
                visual: "üç≠ üßç üßç‚Äç‚ôÄÔ∏è üëµ üëõ",
                choices: [
                    {
                        text: "‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏∂‡πâ‡∏á ‡∏ö‡πà‡∏ô‡∏î‡∏±‡∏á‡πÜ ‡πÉ‡∏´‡πâ‡∏õ‡πâ‡∏≤‡∏£‡∏µ‡∏ö",
                        feedback: {
                            title: "‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‡πÜ ‡∏ô‡∏∞ üò§",
                            desc: "‡∏Å‡∏≤‡∏£‡∏ö‡πà‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡πâ‡∏≤‡∏¢‡∏¥‡πà‡∏á‡∏ï‡∏Å‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏ä‡πâ‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ñ‡∏°‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏®‡∏Å‡πá‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡πâ‡∏ß‡∏¢",
                            icon: "üåßÔ∏è"
                        },
                        effects: { law: 0, public: -15, happy: 5 }
                    },
                    {
                        text: "‡∏£‡∏≠‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡πâ‡∏≤‡∏´‡∏≤‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç",
                        feedback: {
                            title: "‡πÄ‡∏î‡πá‡∏Å‡∏î‡∏µ‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡πÉ‡∏à üíñ",
                            desc: "‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏°‡∏°‡∏≤‡∏Å ‡∏õ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏µ‡πÉ‡∏à‡πÅ‡∏ô‡πà‡πÜ",
                            icon: "üëµ"
                        },
                        effects: { law: 0, public: 15, happy: -5 }
                    }
                ]
            },
            {
                id: 4,
                title: "‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏∏‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ã‡∏µ‡πâ üì±",
                desc: "‡∏°‡∏µ‡∏Ñ‡∏ô‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏•‡∏≤‡∏¢‡∏¢‡∏∑‡∏î‡∏°‡∏≤‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÅ‡∏ä‡∏ó ‡∏ï‡∏•‡∏Å‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢!",
                visual: "üò¥ üì∏ ü§£ üì≤",
                choices: [
                    {
                        text: "‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏´‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡∏Ç‡∏≥‡∏î‡πâ‡∏ß‡∏¢",
                        feedback: {
                            title: "‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏ô‡∏µ‡πâ‡∏ô‡∏∞! üõë",
                            desc: "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏∞‡∏≠‡∏≤‡∏¢‡∏°‡∏≤‡∏Å ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏á‡πÅ‡∏Å‡∏Å‡∏±‡∏ô (Bully) ‡πÅ‡∏•‡∏∞‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢",
                            icon: "üö´"
                        },
                        effects: { law: -25, public: -20, happy: 10 }
                    },
                    {
                        text: "‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠ ‡πÅ‡∏•‡∏∞‡∏ö‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏£‡∏π‡∏õ",
                        feedback: {
                            title: "‡∏Æ‡∏µ‡πÇ‡∏£‡πà‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå! üõ°Ô∏è",
                            desc: "‡∏´‡∏ô‡∏π‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô ‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡πÄ‡∏ï‡∏¥‡∏° ‡∏ô‡∏µ‡πà‡πÅ‡∏´‡∏•‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏ó‡πâ",
                            icon: "ü§ù"
                        },
                        effects: { law: 10, public: 20, happy: -5 }
                    }
                ]
            },
            {
                id: 5,
                title: "‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á üó≥Ô∏è",
                desc: "‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°‡∏µ‡∏£‡∏∏‡πà‡∏ô‡∏û‡∏µ‡πà‡πÄ‡∏≠‡∏≤‡∏Ç‡∏ô‡∏°‡∏°‡∏≤‡πÅ‡∏à‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå 1 ‡∏ô‡∏∞'",
                visual: "üó≥Ô∏è üç¨ ü§´ üè´",
                choices: [
                    {
                        text: "‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏°‡πÑ‡∏ß‡πâ‡∏Å‡∏¥‡∏ô‡∏ü‡∏£‡∏µ‡πÜ (‡∏•‡∏≤‡∏†‡∏õ‡∏≤‡∏Å)",
                        feedback: {
                            title: "‡πÑ‡∏°‡πà‡∏î‡∏µ‡∏°‡∏±‡πâ‡∏á? üí∏",
                            desc: "‡∏Ç‡∏≠‡∏á‡∏ü‡∏£‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô‡πÇ‡∏•‡∏Å ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ '‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏á' ‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ò‡∏¥‡∏õ‡πÑ‡∏ï‡∏¢‡∏ô‡∏∞",
                            icon: "üôÖ"
                        },
                        effects: { law: -30, public: -25, happy: 20 }
                    },
                    {
                        text: "‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö ‡πÅ‡∏•‡∏∞‡∏ö‡∏≠‡∏Å‡∏Ñ‡∏£‡∏π",
                        feedback: {
                            title: "‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå‡∏°‡∏≤‡∏Å! üëè",
                            desc: "‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡πÉ‡∏à‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏™‡∏¥‡∏ô‡∏ö‡∏ô",
                            icon: "üó≥Ô∏è"
                        },
                        effects: { law: 20, public: 20, happy: 0 }
                    }
                ]
            }
        ];

        const game = {
            currentIdx: 0,
            stats: { law: 50, public: 50, happy: 50 },
            
            elements: {
                startScreen: document.getElementById('start-screen'),
                gameScreen: document.getElementById('game-screen'),
                endScreen: document.getElementById('end-screen'),
                hud: document.getElementById('hud'),
                feedbackOverlay: document.getElementById('feedback-overlay'),
                barLaw: document.getElementById('bar-law'),
                barPublic: document.getElementById('bar-public'),
                barHappy: document.getElementById('bar-happy'),
                choicesContainer: document.getElementById('choices-container'),
                qCurrent: document.getElementById('q-current'),
                sceneVisual: document.getElementById('scene-visual'),
                sTitle: document.getElementById('scenario-title'),
                sDesc: document.getElementById('scenario-desc'),
                fTitle: document.getElementById('feedback-title'),
                fDesc: document.getElementById('feedback-desc'),
                fIcon: document.getElementById('feedback-icon'),
                cLaw: document.getElementById('change-law'),
                cPublic: document.getElementById('change-public'),
                cHappy: document.getElementById('change-happy'),
                // End UI
                eRank: document.getElementById('final-rank'),
                eComment: document.getElementById('final-comment'),
                eEmoji: document.getElementById('final-emoji'),
                eLaw: document.getElementById('end-law'),
                ePublic: document.getElementById('end-public'),
                eHappy: document.getElementById('end-happy'),
                ebLaw: document.getElementById('end-bar-law'),
                ebPublic: document.getElementById('end-bar-public'),
                ebHappy: document.getElementById('end-bar-happy'),
            },

            start() {
                this.resetStats();
                this.currentIdx = 0;
                this.elements.startScreen.classList.add('hidden');
                this.elements.endScreen.classList.add('hidden');
                this.elements.hud.classList.remove('hidden');
                this.elements.gameScreen.classList.remove('hidden');
                this.elements.gameScreen.classList.add('flex');
                this.updateStatsUI();
                this.renderScenario();
            },

            resetStats() {
                this.stats = { law: 50, public: 50, happy: 50 };
            },

            updateStatsUI() {
                this.elements.barLaw.style.width = this.stats.law + '%';
                this.elements.barPublic.style.width = this.stats.public + '%';
                this.elements.barHappy.style.width = this.stats.happy + '%';
                
                // Color change logic based on health
                const setBarColor = (el, val, baseColorClass) => {
                    el.className = `h-full transition-all duration-500 rounded-full ${val < 30 ? 'bg-red-400' : baseColorClass}`;
                };
                setBarColor(this.elements.barLaw, this.stats.law, 'bg-blue-400');
                setBarColor(this.elements.barPublic, this.stats.public, 'bg-pink-400');
                setBarColor(this.elements.barHappy, this.stats.happy, 'bg-yellow-400');
            },

            renderScenario() {
                const current = scenarios[this.currentIdx];
                this.elements.qCurrent.innerText = this.currentIdx + 1;
                this.elements.sTitle.innerText = current.title;
                this.elements.sDesc.innerText = current.desc;
                this.elements.sceneVisual.innerHTML = current.visual;

                // Animate scene entry
                this.elements.sceneVisual.classList.remove('animate-pop');
                void this.elements.sceneVisual.offsetWidth; // trigger reflow
                this.elements.sceneVisual.classList.add('animate-pop');

                this.elements.choicesContainer.innerHTML = '';
                current.choices.forEach((choice, index) => {
                    const btn = document.createElement('button');
                    // Colors alternating
                    const colors = ['from-white to-blue-50 border-blue-200', 'from-white to-orange-50 border-orange-200'];
                    const hoverColors = ['hover:bg-blue-100', 'hover:bg-orange-100'];
                    
                    btn.className = `w-full text-left bg-gradient-to-r ${colors[index % 2]} ${hoverColors[index % 2]} p-4 rounded-2xl shadow-sm border-2 transition-all duration-200 group active:scale-95`;
                    btn.onclick = () => this.handleChoice(choice);
                    
                    btn.innerHTML = `
                        <div class="flex items-center">
                            <div class="bg-white border-2 border-gray-100 w-10 h-10 flex items-center justify-center rounded-full mr-4 text-lg font-display font-bold text-gray-400 group-hover:text-kid-blueDark group-hover:border-kid-blueDark shadow-sm">
                                ${String.fromCharCode(65 + index)}
                            </div>
                            <span class="font-body text-lg font-medium text-gray-700 group-hover:text-black">${choice.text}</span>
                        </div>
                    `;
                    this.elements.choicesContainer.appendChild(btn);
                });
                
                // Reset scroll
                this.elements.gameScreen.scrollTop = 0;
            },

            handleChoice(choice) {
                this.stats.law = this.clamp(this.stats.law + choice.effects.law);
                this.stats.public = this.clamp(this.stats.public + choice.effects.public);
                this.stats.happy = this.clamp(this.stats.happy + choice.effects.happy);
                
                this.updateStatsUI();

                this.elements.fTitle.innerText = choice.feedback.title;
                this.elements.fDesc.innerText = choice.feedback.desc;
                this.elements.fIcon.innerText = choice.feedback.icon;

                const formatChange = (val) => {
                    const el = document.createElement('span');
                    el.innerText = val > 0 ? `+${val}` : val;
                    el.className = val > 0 ? 'text-green-500' : (val < 0 ? 'text-red-500' : 'text-gray-400');
                    return el.outerHTML;
                };

                this.elements.cLaw.innerHTML = formatChange(choice.effects.law);
                this.elements.cPublic.innerHTML = formatChange(choice.effects.public);
                this.elements.cHappy.innerHTML = formatChange(choice.effects.happy);

                this.elements.feedbackOverlay.classList.remove('hidden');
            },

            next() {
                this.elements.feedbackOverlay.classList.add('hidden');
                this.currentIdx++;
                
                if (this.currentIdx < scenarios.length) {
                    this.renderScenario();
                } else {
                    this.endGame();
                }
            },

            endGame() {
                this.elements.gameScreen.classList.add('hidden');
                this.elements.hud.classList.add('hidden');
                this.elements.endScreen.classList.remove('hidden');

                // Stats in End Screen
                this.elements.eLaw.innerText = this.stats.law + "%";
                this.elements.ebLaw.style.width = this.stats.law + "%";
                this.elements.ePublic.innerText = this.stats.public + "%";
                this.elements.ebPublic.style.width = this.stats.public + "%";
                this.elements.eHappy.innerText = this.stats.happy + "%";
                this.elements.ebHappy.style.width = this.stats.happy + "%";

                // Rank
                const avg = (this.stats.law + this.stats.public + this.stats.happy) / 3;
                let rank = {};

                if (avg >= 80) {
                    rank = { title: "‡∏Æ‡∏µ‡πÇ‡∏£‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏ä‡∏£ üíé", desc: "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡πÑ‡∏õ‡πÄ‡∏•‡∏¢! ‡∏´‡∏ô‡∏π‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡πá‡∏Å‡∏î‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏à‡∏°‡∏≤‡∏Å", emoji: "ü¶∏‚Äç‚ôÇÔ∏è" };
                } else if (avg >= 60) {
                    rank = { title: "‡∏Æ‡∏µ‡πÇ‡∏£‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏≠‡∏á ü•á", desc: "‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å! ‡∏ó‡∏≥‡∏î‡∏µ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏∞ ‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏ô‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏´‡∏ô‡∏π‡πÄ‡∏•‡∏¢", emoji: "üåü" };
                } else if (avg >= 40) {
                    rank = { title: "‡∏Æ‡∏µ‡πÇ‡∏£‡πà‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î ü•à", desc: "‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß! ‡∏•‡∏≠‡∏á‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Å‡∏é‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡∏ô‡∏∞", emoji: "‚úåÔ∏è" };
                } else {
                    rank = { title: "‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà ü•â", desc: "‡∏™‡∏π‡πâ‡πÜ ‡∏ô‡∏∞! ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏î‡∏µ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏¢‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡πÅ‡∏ï‡πà‡∏´‡∏ô‡∏π‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô", emoji: "üå±" };
                }

                this.elements.eRank.innerText = rank.title;
                this.elements.eComment.innerText = rank.desc;
                this.elements.eEmoji.innerText = rank.emoji;
            },

            restart() {
                this.start();
            },

            clamp(val) { return Math.min(100, Math.max(0, val)); }
        };
    </script>
</body>
</html>
